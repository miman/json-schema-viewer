{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/person.schema.json",
  "title": "Person",
  "description": "A schema representing a person with their personal and professional information",
  "type": "object",
  "properties": {
    "firstName": {
      "type": "string",
      "description": "The person's first name",
      "minLength": 1,
      "maxLength": 100
    },
    "lastName": {
      "type": "string",
      "description": "The person's last name",
      "minLength": 1,
      "maxLength": 100
    },
    "age": {
      "type": "integer",
      "description": "Age in years",
      "minimum": 0,
      "maximum": 150
    },
    "email": {
      "$ref": "common_defs.schema.json#/$defs/EmailFormat"
    },
    "missing": {
      "$ref": "missing_defs.schema.json#/$defs/EmailFormat"
    },
    "phone": {
      "type": "string",
      "description": "Phone number in international format",
      "pattern": "^\\+[1-9]\\d{1,14}$"
    },
    "gender": {
      "type": "string",
      "description": "Gender of the person",
      "enum": [
        "male",
        "female",
        "other",
        "prefer_not_to_say"
      ]
    },
    "contactAddresses": {
      "type": "array",
      "items": { "$ref": "address.schema.json" },
      "minItems": 1
    },
    "isEmployed": {
      "type": "boolean",
      "description": "Whether the person is currently employed",
      "default": false
    },
    "address": {
      "$ref": "#/definitions/Address",
      "description": "The person's primary address"
    },
    "workHistory": {
      "type": "array",
      "description": "List of previous and current employment",
      "items": {
        "$ref": "#/definitions/Employment"
      },
      "minItems": 0,
      "maxItems": 50
    },
    "skills": {
      "type": "array",
      "description": "List of skills",
      "items": {
        "type": "string"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "When this record was created"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "When this record was last updated"
        },
        "version": {
          "type": "integer",
          "description": "Version number of this record",
          "default": 1
        }
      }
    }
  },
  "required": [
    "firstName",
    "lastName",
    "email"
  ],
  "definitions": {
    "Address": {
      "type": "object",
      "description": "A physical address",
      "properties": {
        "street": {
          "type": "string",
          "description": "Street name and number"
        },
        "city": {
          "type": "string",
          "description": "City name"
        },
        "state": {
          "type": "string",
          "description": "State or province"
        },
        "postalCode": {
          "type": "string",
          "description": "Postal or ZIP code",
          "pattern": "^[0-9]{5}(-[0-9]{4})?$"
        },
        "country": {
          "type": "string",
          "description": "Country name or ISO code",
          "default": "USA"
        }
      },
      "required": [
        "street",
        "city",
        "country"
      ]
    },
    "Employment": {
      "type": "object",
      "description": "Employment record",
      "properties": {
        "company": {
          "type": "string",
          "description": "Name of the employer"
        },
        "position": {
          "type": "string",
          "description": "Job title or position"
        },
        "startDate": {
          "type": "string",
          "format": "date",
          "description": "Start date of employment"
        },
        "endDate": {
          "type": "string",
          "format": "date",
          "description": "End date of employment (null if current)"
        },
        "isCurrent": {
          "type": "boolean",
          "description": "Whether this is the current job",
          "default": false
        },
        "salary": {
          "type": "number",
          "description": "Annual salary",
          "minimum": 0
        },
        "responsibilities": {
          "type": "array",
          "description": "List of job responsibilities",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "company",
        "position",
        "startDate"
      ]
    }
  },
  "allOf": [
    { "not": { "properties": { "name": { "const": "GÃ¤st" } } } }
  ],
  "if": {
    "properties": { "age": { "minimum": 18 } }
  },
  "then": {
    "properties": { "email": { "$ref": "common_defs.schema.json#/$defs/EmailRequired" } }
  }

}